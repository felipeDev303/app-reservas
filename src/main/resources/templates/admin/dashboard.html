<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Admin - Panel de Control</title>

    <!-- Bootstrap 5 CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <!-- Bootstrap Icons -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.2/font/bootstrap-icons.css"
    />
  </head>
  <body class="bg-light">
    <!-- Header -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary shadow-sm">
      <div class="container-fluid px-4">
        <span class="navbar-brand mb-0 h1">
          <i class="bi bi-speedometer2 me-2"></i>Panel de Administración
        </span>
        <a href="/" class="btn btn-light">
          <i class="bi bi-house me-2"></i>Volver al Inicio
        </a>
      </div>
    </nav>

    <!-- Main Content -->
    <div class="container my-5">
      <div class="row g-4">
        <!-- Gestión Card -->
        <div class="col-md-6 col-lg-4">
          <div class="card h-100 shadow-sm border-0">
            <div class="card-body">
              <h5 class="card-title text-primary mb-4">
                <i class="bi bi-grid-3x3-gap me-2"></i>Gestión
              </h5>
              <div class="d-grid gap-2">
                <a href="/mesas" class="btn btn-outline-primary">
                  <i class="bi bi-table me-2"></i>Ver Mesas
                </a>
                <a href="/reservas" class="btn btn-outline-primary">
                  <i class="bi bi-calendar-check me-2"></i>Ver Reservas
                </a>
                <a href="/reserva/nueva" class="btn btn-outline-primary">
                  <i class="bi bi-plus-circle me-2"></i>Nueva Reserva
                </a>
              </div>
            </div>
          </div>
        </div>

        <!-- Estadísticas Card -->
        <div class="col-md-6 col-lg-4">
          <div class="card h-100 shadow-sm border-0">
            <div class="card-body">
              <h5 class="card-title text-primary mb-4">
                <i class="bi bi-graph-up me-2"></i>Estadísticas
              </h5>
              <div class="row g-3">
                <div class="col-6">
                  <div class="card bg-primary text-white text-center">
                    <div class="card-body p-3">
                      <h2 class="mb-0" id="mesasCount">-</h2>
                      <small>Mesas Totales</small>
                    </div>
                  </div>
                </div>
                <div class="col-6">
                  <div class="card bg-success text-white text-center">
                    <div class="card-body p-3">
                      <h2 class="mb-0" id="reservasCount">-</h2>
                      <small>Reservas Activas</small>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Herramientas Card -->
        <div class="col-md-12 col-lg-4">
          <div class="card h-100 shadow-sm border-0">
            <div class="card-body">
              <h5 class="card-title text-primary mb-4">
                <i class="bi bi-tools me-2"></i>Herramientas
              </h5>
              <a
                href="/h2-console"
                target="_blank"
                class="btn btn-outline-secondary w-100 mb-3"
              >
                <i class="bi bi-database me-2"></i>Consola H2 Database
              </a>
              <div class="alert alert-info mb-0">
                <small>
                  <strong>URL JDBC:</strong> jdbc:h2:mem:reservasdb<br />
                  <strong>Usuario:</strong> sa<br />
                  <strong>Password:</strong> (vacío)
                </small>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Endpoints API Card -->
      <div class="card shadow-sm border-0 mt-4">
        <div class="card-body">
          <h5 class="card-title text-primary mb-4">
            <i class="bi bi-server me-2"></i>Endpoints API REST
          </h5>

          <!-- Mesas -->
          <h6 class="text-secondary mb-3">Mesas</h6>
          <div class="list-group mb-4">
            <a
              href="/api/mesas"
              target="_blank"
              class="list-group-item list-group-item-action"
            >
              <span class="badge bg-success me-2">GET</span>
              <code class="text-dark">/api/mesas</code>
            </a>
            <a
              href="/api/mesas/1"
              target="_blank"
              class="list-group-item list-group-item-action"
            >
              <span class="badge bg-success me-2">GET</span>
              <code class="text-dark">/api/mesas/{id}</code>
            </a>
            <a
              href="/api/mesas/tipo/INTERIOR"
              target="_blank"
              class="list-group-item list-group-item-action"
            >
              <span class="badge bg-success me-2">GET</span>
              <code class="text-dark">/api/mesas/tipo/{tipo}</code>
            </a>
          </div>

          <!-- Reservas -->
          <h6 class="text-secondary mb-3">Reservas</h6>
          <div class="list-group mb-4">
            <a
              href="/api/reservas"
              target="_blank"
              class="list-group-item list-group-item-action"
            >
              <span class="badge bg-success me-2">GET</span>
              <code class="text-dark">/api/reservas</code>
            </a>
            <a
              href="/api/reservas/1"
              target="_blank"
              class="list-group-item list-group-item-action"
            >
              <span class="badge bg-success me-2">GET</span>
              <code class="text-dark">/api/reservas/{id}</code>
            </a>
            <div class="list-group-item">
              <span class="badge bg-primary me-2">POST</span>
              <code class="text-dark">/api/reservas</code>
              <span class="text-muted ms-2">(Crear reserva)</span>
            </div>
          </div>

          <!-- Disponibilidad -->
          <h6 class="text-secondary mb-3">Disponibilidad</h6>
          <div class="list-group">
            <a
              href="/api/disponibilidad/fecha/2025-11-21"
              target="_blank"
              class="list-group-item list-group-item-action"
            >
              <span class="badge bg-success me-2">GET</span>
              <code class="text-dark">/api/disponibilidad/fecha/{fecha}</code>
            </a>
          </div>
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script>
      // Cargar estadísticas
      async function loadStats() {
        try {
          const [mesasRes, reservasRes] = await Promise.all([
            fetch("/api/mesas"),
            fetch("/api/reservas"),
          ]);

          const mesas = await mesasRes.json();
          const reservas = await reservasRes.json();

          document.getElementById("mesasCount").textContent = mesas.length || 0;
          document.getElementById("reservasCount").textContent =
            reservas.length || 0;
        } catch (error) {
          console.error("Error cargando estadísticas:", error);
        }
      }

      loadStats();
    </script>
  </body>
</html>
